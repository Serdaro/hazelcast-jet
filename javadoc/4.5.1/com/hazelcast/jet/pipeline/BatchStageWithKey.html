<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (14) on Fri Sep 10 08:25:44 CEST 2021 -->
<title>BatchStageWithKey (hazelcast-jet-distribution 4.5.1 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2021-09-10">
<meta name="description" content="declaration: package: com.hazelcast.jet.pipeline, interface: BatchStageWithKey">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":6,"i1":18,"i2":6,"i3":18,"i4":6,"i5":18,"i6":18,"i7":18,"i8":6,"i9":18,"i10":6,"i11":6,"i12":6,"i13":6,"i14":6,"i15":6,"i16":18,"i17":18,"i18":6,"i19":6,"i20":18,"i21":6,"i22":6,"i23":18};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],16:["t5","Default Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flexBox">
<header role="banner" class="flexHeader">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BatchStageWithKey.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="skipNav"><a id="skip.navbar.top">
<!--   -->
</a></div>
</nav>
</header>
<div class="flexContent">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.hazelcast.jet.pipeline</a></div>
<h1 title="Interface BatchStageWithKey" class="title">Interface BatchStageWithKey&lt;T,&#8203;K&gt;</h1>
</div>
<div class="contentContainer">
<section class="description">
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - type of the input item</dd>
<dd><code>K</code> - type of the key</dd>
</dl>
<dl>
<dt>All Superinterfaces:</dt>
<dd><code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;T,&#8203;K&gt;</code></dd>
</dl>
<hr>
<pre>public interface <span class="typeNameLabel">BatchStageWithKey&lt;T,&#8203;K&gt;</span>
extends <a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;T,&#8203;K&gt;</pre>
<div class="block">An intermediate step while constructing a group-and-aggregate batch
 pipeline stage. It captures the grouping key and offers the methods to
 finalize the construction by specifying the aggregate operation and any
 additional pipeline stages contributing their data to a
 co-group-and-aggregate stage.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>3.0</dd>
</dl>
</section>
<section class="summary">
<ul class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
<!--   -->
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t3" class="tableTab" onclick="show(4);">Abstract Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t5" class="tableTab" onclick="show(16);">Default Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>&lt;R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;R&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#aggregate(com.hazelcast.jet.aggregate.AggregateOperation1)">aggregate</a></span>&#8203;(<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;?,&#8203;? extends R&gt;&nbsp;aggrOp)</code></th>
<td class="colLast">
<div class="block">Attaches a stage that performs the given group-and-aggregate operation.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>default &lt;T1,&#8203;
R0,&#8203;
R1&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;<a href="../datamodel/Tuple2.html" title="class in com.hazelcast.jet.datamodel">Tuple2</a>&lt;R0,&#8203;R1&gt;&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#aggregate2(com.hazelcast.jet.aggregate.AggregateOperation1,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation1)">aggregate2</a></span>&#8203;(<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;?,&#8203;? extends R0&gt;&nbsp;aggrOp0,
<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;? extends T1,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage1,
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super T1,&#8203;?,&#8203;? extends R1&gt;&nbsp;aggrOp1)</code></th>
<td class="colLast">
<div class="block">Attaches a stage that performs the given cogroup-and-aggregate
 transformation of the items from both this stage and <code>stage1</code>
 you supply.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>&lt;T1,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;R&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#aggregate2(com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation2)">aggregate2</a></span>&#8203;(<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;T1,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage1,
<a href="../aggregate/AggregateOperation2.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation2</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? super T1,&#8203;?,&#8203;R&gt;&nbsp;aggrOp)</code></th>
<td class="colLast">
<div class="block">Attaches a stage that performs the given cogroup-and-aggregate operation
 over the items from both this stage and <code>stage1</code> you supply.</div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code>default &lt;T1,&#8203;
T2,&#8203;
R0,&#8203;
R1,&#8203;
R2&gt;<br><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;<a href="../datamodel/Tuple3.html" title="class in com.hazelcast.jet.datamodel">Tuple3</a>&lt;R0,&#8203;R1,&#8203;R2&gt;&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#aggregate3(com.hazelcast.jet.aggregate.AggregateOperation1,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation1,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation1)">aggregate3</a></span>&#8203;(<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;?,&#8203;? extends R0&gt;&nbsp;aggrOp0,
<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;T1,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage1,
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super T1,&#8203;?,&#8203;? extends R1&gt;&nbsp;aggrOp1,
<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;T2,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage2,
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super T2,&#8203;?,&#8203;? extends R2&gt;&nbsp;aggrOp2)</code></th>
<td class="colLast">
<div class="block">Attaches a stage that performs the given cogroup-and-aggregate
 transformation of the items from this stage as well as <code>stage1</code>
 and <code>stage2</code> you supply.</div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>&lt;T1,&#8203;
T2,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;R&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#aggregate3(com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation3)">aggregate3</a></span>&#8203;(<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;T1,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage1,
<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;T2,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage2,
<a href="../aggregate/AggregateOperation3.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation3</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? super T1,&#8203;? super T2,&#8203;?,&#8203;? extends R&gt;&nbsp;aggrOp)</code></th>
<td class="colLast">
<div class="block">Attaches a stage that performs the given cogroup-and-aggregate operation
 over the items from this stage as well as <code>stage1</code> and <code>
 stage2</code> you supply.</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>default <a href="GroupAggregateBuilder1.html" title="class in com.hazelcast.jet.pipeline">GroupAggregateBuilder1</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#aggregateBuilder()">aggregateBuilder</a></span>()</code></th>
<td class="colLast">
<div class="block">Offers a step-by-step API to build a pipeline stage that co-aggregates
 the data from several input stages.</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>default &lt;R0&gt;&nbsp;<a href="GroupAggregateBuilder.html" title="class in com.hazelcast.jet.pipeline">GroupAggregateBuilder</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;R0&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#aggregateBuilder(com.hazelcast.jet.aggregate.AggregateOperation1)">aggregateBuilder</a></span>&#8203;(<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;?,&#8203;? extends R0&gt;&nbsp;aggrOp0)</code></th>
<td class="colLast">
<div class="block">Offers a step-by-step API to build a pipeline stage that co-aggregates
 the data from several input stages.</div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>default &lt;R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#customTransform(java.lang.String,com.hazelcast.function.SupplierEx)">customTransform</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;stageName,
<a href="../../function/SupplierEx.html" title="interface in com.hazelcast.function">SupplierEx</a>&lt;<a href="../core/Processor.html" title="interface in com.hazelcast.jet.core">Processor</a>&gt;&nbsp;procSupplier)</code></th>
<td class="colLast">
<div class="block">Attaches a stage with a custom transform based on the provided supplier
 of Core API <a href="../core/Processor.html" title="interface in com.hazelcast.jet.core"><code>Processor</code></a>s.</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code>&lt;R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#customTransform(java.lang.String,com.hazelcast.jet.core.ProcessorMetaSupplier)">customTransform</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;stageName,
<a href="../core/ProcessorMetaSupplier.html" title="interface in com.hazelcast.jet.core">ProcessorMetaSupplier</a>&nbsp;procSupplier)</code></th>
<td class="colLast">
<div class="block">Attaches a stage with a custom transform based on the provided supplier
 of Core API <a href="../core/Processor.html" title="interface in com.hazelcast.jet.core"><code>Processor</code></a>s.</div>
</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code>default &lt;R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#customTransform(java.lang.String,com.hazelcast.jet.core.ProcessorSupplier)">customTransform</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;stageName,
<a href="../core/ProcessorSupplier.html" title="interface in com.hazelcast.jet.core">ProcessorSupplier</a>&nbsp;procSupplier)</code></th>
<td class="colLast">
<div class="block">Attaches a stage with a custom transform based on the provided supplier
 of Core API <a href="../core/Processor.html" title="interface in com.hazelcast.jet.core"><code>Processor</code></a>s.</div>
</td>
</tr>
<tr class="altColor" id="i10">
<td class="colFirst"><code><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#distinct()">distinct</a></span>()</code></th>
<td class="colLast">
<div class="block">Attaches a stage that emits just the items that are distinct according
 to the grouping key (no two items which map to the same key will be on
 the output).</div>
</td>
</tr>
<tr class="rowColor" id="i11">
<td class="colFirst"><code>&lt;S&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#filterStateful(com.hazelcast.function.SupplierEx,com.hazelcast.function.BiPredicateEx)">filterStateful</a></span>&#8203;(<a href="../../function/SupplierEx.html" title="interface in com.hazelcast.function">SupplierEx</a>&lt;? extends S&gt;&nbsp;createFn,
<a href="../../function/BiPredicateEx.html" title="interface in com.hazelcast.function">BiPredicateEx</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;&nbsp;filterFn)</code></th>
<td class="colLast">
<div class="block">Attaches a stage that performs a stateful filtering operation.</div>
</td>
</tr>
<tr class="altColor" id="i12">
<td class="colFirst"><code>&lt;S&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#filterUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriPredicate)">filterUsingService</a></span>&#8203;(<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
<a href="../function/TriPredicate.html" title="interface in com.hazelcast.jet.function">TriPredicate</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;&nbsp;filterFn)</code></th>
<td class="colLast">
<div class="block">Attaches a filtering stage which applies the provided predicate function
 to each input item to decide whether to pass the item to the output or
 to discard it.</div>
</td>
</tr>
<tr class="rowColor" id="i13">
<td class="colFirst"><code>&lt;S,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#flatMapStateful(com.hazelcast.function.SupplierEx,com.hazelcast.jet.function.TriFunction)">flatMapStateful</a></span>&#8203;(<a href="../../function/SupplierEx.html" title="interface in com.hazelcast.function">SupplierEx</a>&lt;? extends S&gt;&nbsp;createFn,
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? extends <a href="../Traverser.html" title="interface in com.hazelcast.jet">Traverser</a>&lt;R&gt;&gt;&nbsp;flatMapFn)</code></th>
<td class="colLast">
<div class="block">Attaches a stage that performs a stateful flat-mapping operation.</div>
</td>
</tr>
<tr class="altColor" id="i14">
<td class="colFirst"><code>&lt;S,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#flatMapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">flatMapUsingService</a></span>&#8203;(<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? extends <a href="../Traverser.html" title="interface in com.hazelcast.jet">Traverser</a>&lt;R&gt;&gt;&nbsp;flatMapFn)</code></th>
<td class="colLast">
<div class="block">Attaches a flat-mapping stage which applies the supplied function to
 each input item independently and emits all the items from the
 <a href="../Traverser.html" title="interface in com.hazelcast.jet"><code>Traverser</code></a> it returns as the output items.</div>
</td>
</tr>
<tr class="rowColor" id="i15">
<td class="colFirst"><code>&lt;S,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mapStateful(com.hazelcast.function.SupplierEx,com.hazelcast.jet.function.TriFunction)">mapStateful</a></span>&#8203;(<a href="../../function/SupplierEx.html" title="interface in com.hazelcast.function">SupplierEx</a>&lt;? extends S&gt;&nbsp;createFn,
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? extends R&gt;&nbsp;mapFn)</code></th>
<td class="colLast">
<div class="block">Attaches a stage that performs a stateful mapping operation.</div>
</td>
</tr>
<tr class="altColor" id="i16">
<td class="colFirst"><code>default &lt;V,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mapUsingIMap(com.hazelcast.map.IMap,com.hazelcast.function.BiFunctionEx)">mapUsingIMap</a></span>&#8203;(<a href="../../map/IMap.html" title="interface in com.hazelcast.map">IMap</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;V&gt;&nbsp;iMap,
<a href="../../function/BiFunctionEx.html" title="interface in com.hazelcast.function">BiFunctionEx</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? super V,&#8203;? extends R&gt;&nbsp;mapFn)</code></th>
<td class="colLast">
<div class="block">Attaches a mapping stage where for each item a lookup in the
 supplied <code>IMap</code> using the grouping key is performed
 and the result of the lookup is merged with the item and emitted.</div>
</td>
</tr>
<tr class="rowColor" id="i17">
<td class="colFirst"><code>default &lt;V,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mapUsingIMap(java.lang.String,com.hazelcast.function.BiFunctionEx)">mapUsingIMap</a></span>&#8203;(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;mapName,
<a href="../../function/BiFunctionEx.html" title="interface in com.hazelcast.function">BiFunctionEx</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? super V,&#8203;? extends R&gt;&nbsp;mapFn)</code></th>
<td class="colLast">
<div class="block">Attaches a mapping stage where for each item a lookup in the
 <code>IMap</code> with the supplied name using the grouping key is performed
 and the result of the lookup is merged with the item and emitted.</div>
</td>
</tr>
<tr class="altColor" id="i18">
<td class="colFirst"><code>&lt;S,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">mapUsingService</a></span>&#8203;(<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? extends R&gt;&nbsp;mapFn)</code></th>
<td class="colLast">
<div class="block">Attaches a mapping stage which applies the given function to each input
 item independently and emits the function's result as the output item.</div>
</td>
</tr>
<tr class="rowColor" id="i19">
<td class="colFirst"><code>&lt;S,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,int,boolean,com.hazelcast.jet.function.TriFunction)">mapUsingServiceAsync</a></span>&#8203;(<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
int&nbsp;maxConcurrentOps,
boolean&nbsp;preserveOrder,
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">CompletableFuture</a>&lt;R&gt;&gt;&nbsp;mapAsyncFn)</code></th>
<td class="colLast">
<div class="block">Asynchronous version of <a href="GeneralStageWithKey.html#mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)"><code>GeneralStageWithKey.mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory&lt;?, S&gt;, com.hazelcast.jet.function.TriFunction&lt;? super S, ? super K, ? super T, ? extends R&gt;)</code></a>: the <code>mapAsyncFn</code>
 returns a <code>CompletableFuture&lt;R&gt;</code> instead of just <code>R</code>.</div>
</td>
</tr>
<tr class="altColor" id="i20">
<td class="colFirst"><code>default &lt;S,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">mapUsingServiceAsync</a></span>&#8203;(<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">CompletableFuture</a>&lt;R&gt;&gt;&nbsp;mapAsyncFn)</code></th>
<td class="colLast">
<div class="block">Asynchronous version of <a href="GeneralStageWithKey.html#mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)"><code>GeneralStageWithKey.mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory&lt;?, S&gt;, com.hazelcast.jet.function.TriFunction&lt;? super S, ? super K, ? super T, ? extends R&gt;)</code></a>: the <code>mapAsyncFn</code>
 returns a <code>CompletableFuture&lt;R&gt;</code> instead of just <code>R</code>.</div>
</td>
</tr>
<tr class="rowColor" id="i21">
<td class="colFirst"><code>&lt;S,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mapUsingServiceAsyncBatched(com.hazelcast.jet.pipeline.ServiceFactory,int,com.hazelcast.function.BiFunctionEx)">mapUsingServiceAsyncBatched</a></span>&#8203;(<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
int&nbsp;maxBatchSize,
<a href="../../function/BiFunctionEx.html" title="interface in com.hazelcast.function">BiFunctionEx</a>&lt;? super S,&#8203;? super <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;,&#8203;? extends <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;R&gt;&gt;&gt;&nbsp;mapAsyncFn)</code></th>
<td class="colLast">
<div class="block">Batched version of <a href="GeneralStageWithKey.html#mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)"><code>GeneralStageWithKey.mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory&lt;?, S&gt;, com.hazelcast.jet.function.TriFunction&lt;? super S, ? super K, ? super T, java.util.concurrent.CompletableFuture&lt;R&gt;&gt;)</code></a>: <code>mapAsyncFn</code> takes
 a list of input items and returns a <code>CompletableFuture&lt;List&lt;R&gt;&gt;</code>.</div>
</td>
</tr>
<tr class="altColor" id="i22">
<td class="colFirst"><code>&lt;S,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mapUsingServiceAsyncBatched(com.hazelcast.jet.pipeline.ServiceFactory,int,com.hazelcast.jet.function.TriFunction)">mapUsingServiceAsyncBatched</a></span>&#8203;(<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
int&nbsp;maxBatchSize,
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;,&#8203;? super <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;,&#8203;? extends <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;R&gt;&gt;&gt;&nbsp;mapAsyncFn)</code></th>
<td class="colLast">
<div class="block">Batched version of <a href="GeneralStageWithKey.html#mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)"><code>GeneralStageWithKey.mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory&lt;?, S&gt;, com.hazelcast.jet.function.TriFunction&lt;? super S, ? super K, ? super T, java.util.concurrent.CompletableFuture&lt;R&gt;&gt;)</code></a>: <code>mapAsyncFn</code> takes
 a list of input items (and a list of their corresponding keys) and
 returns a <code>CompletableFuture&lt;List&lt;R&gt;&gt;</code>.</div>
</td>
</tr>
<tr class="rowColor" id="i23">
<td class="colFirst"><code>default &lt;A,&#8203;
R&gt;&nbsp;<a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;R&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#rollingAggregate(com.hazelcast.jet.aggregate.AggregateOperation1)">rollingAggregate</a></span>&#8203;(<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;A,&#8203;? extends R&gt;&nbsp;aggrOp)</code></th>
<td class="colLast">
<div class="block">Attaches a rolling aggregation stage.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from interface&nbsp;com.hazelcast.jet.pipeline.<a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a></h3>
<a id="methods.inherited.from.class.com.hazelcast.jet.pipeline.GeneralStageWithKey">
<!--   -->
</a><code><a href="GeneralStageWithKey.html#keyFn()">keyFn</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
<!--   -->
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="distinct()">distinct</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;</span>&nbsp;<span class="memberName">distinct</span>()</div>
<div class="block">Attaches a stage that emits just the items that are distinct according
 to the grouping key (no two items which map to the same key will be on
 the output). There is no guarantee which one of the items with the same
 key it will emit.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="mapStateful(com.hazelcast.function.SupplierEx,com.hazelcast.jet.function.TriFunction)">mapStateful</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;S,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">mapStateful</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../../function/SupplierEx.html" title="interface in com.hazelcast.function">SupplierEx</a>&lt;? extends S&gt;&nbsp;createFn,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? extends R&gt;&nbsp;mapFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#mapStateful(com.hazelcast.function.SupplierEx,com.hazelcast.jet.function.TriFunction)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a stage that performs a stateful mapping operation. <code>
 createFn</code> returns the object that holds the state. Jet passes this
 object along with each input item and its key to <code>mapFn</code>, which
 can update the object's state. For each grouping key there's a separate
 state object. The state object will be included in the state snapshot,
 so it survives job restarts. For this reason it must be serializable.
 <p>
 This sample takes a stream of pairs <code>(serverId, latency)</code>
 representing the latencies of serving individual requests and outputs
 the cumulative latency of all handled requests so far, for each
 server separately:
 <pre><code>
 GeneralStage&lt;Entry&lt;String, Long&gt;&gt; latencies;
 GeneralStage&lt;Entry&lt;String, Long&gt;&gt; cumulativeLatencies = latencies
         .groupingKey(Entry::getKey)
         .mapStateful(
                 LongAccumulator::new,
                 (sum, key, entry) -&gt; {
                     sum.add(entry.getValue());
                     return entry(key, sum.get());
                 }
         );
 </code></pre>
 This code has the same result as <a href="GeneralStageWithKey.html#rollingAggregate(com.hazelcast.jet.aggregate.AggregateOperation1)"><code>latencies.groupingKey(Entry::getKey).rollingAggregate(summing())</code></a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#mapStateful(com.hazelcast.function.SupplierEx,com.hazelcast.jet.function.TriFunction)">mapStateful</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>S</code> - type of the state object</dd>
<dd><code>R</code> - type of the result</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>createFn</code> - function that returns the state object</dd>
<dd><code>mapFn</code> - function that receives the state object and the input item and
                 outputs the result item. It may modify the state object. It must be
                 stateless and <a href="../core/Processor.html#isCooperative()">cooperative</a>.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="filterStateful(com.hazelcast.function.SupplierEx,com.hazelcast.function.BiPredicateEx)">filterStateful</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;S&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;</span>&nbsp;<span class="memberName">filterStateful</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../../function/SupplierEx.html" title="interface in com.hazelcast.function">SupplierEx</a>&lt;? extends S&gt;&nbsp;createFn,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../../function/BiPredicateEx.html" title="interface in com.hazelcast.function">BiPredicateEx</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;&nbsp;filterFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#filterStateful(com.hazelcast.function.SupplierEx,com.hazelcast.function.BiPredicateEx)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a stage that performs a stateful filtering operation. <code>
 createFn</code> returns the object that holds the state. Jet passes this
 object along with each input item and its key to <code>filterFn</code>, which
 can update the object's state. For each grouping key there's a separate
 state object. The state object will be included in the state snapshot,
 so it survives job restarts. For this reason it must be serializable.
 <p>
 This sample groups a stream of strings by length and decimates each
 group (throws out every 10th string of each length):
 <pre><code>
 GeneralStage&lt;String&gt; decimated = input
         .groupingKey(String::length)
         .filterStateful(
                 LongAccumulator::new,
                 (counter, item) -&gt; {
                     counter.add(1);
                     return counter.get() % 10 != 0;
                 }
         );
 </code></pre>
 <p>
 The given functions must be stateless and <a href="../core/Processor.html#isCooperative()">cooperative</a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#filterStateful(com.hazelcast.function.SupplierEx,com.hazelcast.function.BiPredicateEx)">filterStateful</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>S</code> - type of the state object</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>createFn</code> - function that returns the state object</dd>
<dd><code>filterFn</code> - predicate that receives the state object and the input item and
                 outputs a boolean value. It may modify the state object.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="flatMapStateful(com.hazelcast.function.SupplierEx,com.hazelcast.jet.function.TriFunction)">flatMapStateful</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;S,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">flatMapStateful</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../../function/SupplierEx.html" title="interface in com.hazelcast.function">SupplierEx</a>&lt;? extends S&gt;&nbsp;createFn,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? extends <a href="../Traverser.html" title="interface in com.hazelcast.jet">Traverser</a>&lt;R&gt;&gt;&nbsp;flatMapFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#flatMapStateful(com.hazelcast.function.SupplierEx,com.hazelcast.jet.function.TriFunction)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a stage that performs a stateful flat-mapping operation. <code>
 createFn</code> returns the object that holds the state. Jet passes this
 object along with each input item and its key to <code>flatMapFn</code>,
 which can update the object's state. For each grouping key there's a
 separate state object. The state object will be included in the state
 snapshot, so it survives job restarts. For this reason it must be
 serializable.
 <p>
 This sample groups a stream of strings by length and inserts punctuation
 (a special string) after every 10th string in each group:
 <pre><code>
 GeneralStage&lt;String&gt; punctuated = input
         .groupingKey(String::length)
         .flatMapStateful(
                 LongAccumulator::new,
                 (counter, key, item) -&gt; {
                     counter.add(1);
                     return counter.get() % 10 == 0
                             ? Traversers.traverseItems("punctuation" + key, item)
                             : Traversers.singleton(item);
                 }
         );
 </code></pre>
 <p>
 The given functions must be stateless and <a href="../core/Processor.html#isCooperative()">cooperative</a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#flatMapStateful(com.hazelcast.function.SupplierEx,com.hazelcast.jet.function.TriFunction)">flatMapStateful</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>S</code> - type of the state object</dd>
<dd><code>R</code> - type of the result</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>createFn</code> - function that returns the state object</dd>
<dd><code>flatMapFn</code> - function that receives the state object and the input item and
                  outputs the result items. It may modify the state
                  object. It must not return null traverser, but can
                  return an <a href="../Traversers.html#empty()">empty traverser</a>.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="rollingAggregate(com.hazelcast.jet.aggregate.AggregateOperation1)">rollingAggregate</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="modifiers">default</span>&nbsp;<span class="typeParameters">&lt;A,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;R&gt;&gt;</span>&nbsp;<span class="memberName">rollingAggregate</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;A,&#8203;? extends R&gt;&nbsp;aggrOp)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#rollingAggregate(com.hazelcast.jet.aggregate.AggregateOperation1)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a rolling aggregation stage. This is a special case of
 <a href="GeneralStageWithKey.html#mapStateful(com.hazelcast.function.SupplierEx,com.hazelcast.jet.function.TriFunction)">stateful mapping</a> that uses an <a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate"><code>AggregateOperation</code></a>. It passes each input item to
 the accumulator and outputs the current result of aggregation (as
 returned by the <a href="../aggregate/AggregateOperation.html#exportFn()"><code>export</code></a> primitive).
 <p>
 Sample usage:
 <pre><code>
 StreamStage&lt;Entry&lt;Color, Long&gt;&gt; aggregated = items
         .groupingKey(Item::getColor)
         .rollingAggregate(AggregateOperations.counting());
 </code></pre>
 For example, if your input is <code>{2, 7, 8, -5}</code>, the output will be
 <code>{2, 9, 17, 12}</code>.
 <p>
 This stage is fault-tolerant and saves its state to the snapshot.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#rollingAggregate(com.hazelcast.jet.aggregate.AggregateOperation1)">rollingAggregate</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dd><code>R</code> - type of the aggregate operation result</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>aggrOp</code> - the aggregate operation to perform</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="mapUsingIMap(java.lang.String,com.hazelcast.function.BiFunctionEx)">mapUsingIMap</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="modifiers">default</span>&nbsp;<span class="typeParameters">&lt;V,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">mapUsingIMap</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;mapName,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../../function/BiFunctionEx.html" title="interface in com.hazelcast.function">BiFunctionEx</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? super V,&#8203;? extends R&gt;&nbsp;mapFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#mapUsingIMap(java.lang.String,com.hazelcast.function.BiFunctionEx)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a mapping stage where for each item a lookup in the
 <code>IMap</code> with the supplied name using the grouping key is performed
 and the result of the lookup is merged with the item and emitted.
 <p>
 If the result of the mapping is <code>null</code>, it emits nothing.
 Therefore this stage can be used to implement filtering semantics as well.
 <p>
 The mapping logic is equivalent to:
 <pre><code>
 V value = map.get(groupingKey);
 return mapFn.apply(item, value);
 </code></pre>

 Sample usage:
 <pre><code>
 items.groupingKey(Item::getDetailId)
      .mapUsingIMap(
              "enriching-map",
              (Item item, ItemDetail detail) -&gt; item.setDetail(detail)
      );
 </code></pre>
 This stage is similar to <a href="GeneralStage.html#mapUsingIMap(com.hazelcast.map.IMap,com.hazelcast.function.FunctionEx,com.hazelcast.function.BiFunctionEx)"><code>stageWithoutKey.mapUsingIMap()</code></a>,
 but here Jet knows the key and uses it to partition and distribute the input in order
 to achieve data locality. The value it fetches from the <code>IMap</code> is
 stored on the cluster member where the processing takes place. However,
 if the map doesn't use the default partitioning strategy, the data
 locality will be broken.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#mapUsingIMap(java.lang.String,com.hazelcast.function.BiFunctionEx)">mapUsingIMap</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>V</code> - type of the value in the <code>IMap</code></dd>
<dd><code>R</code> - type of the output item</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mapName</code> - name of the <code>IMap</code></dd>
<dd><code>mapFn</code> - the mapping function. It must be stateless and <a href="../core/Processor.html#isCooperative()">cooperative</a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="mapUsingIMap(com.hazelcast.map.IMap,com.hazelcast.function.BiFunctionEx)">mapUsingIMap</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="modifiers">default</span>&nbsp;<span class="typeParameters">&lt;V,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">mapUsingIMap</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../../map/IMap.html" title="interface in com.hazelcast.map">IMap</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;V&gt;&nbsp;iMap,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../../function/BiFunctionEx.html" title="interface in com.hazelcast.function">BiFunctionEx</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? super V,&#8203;? extends R&gt;&nbsp;mapFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#mapUsingIMap(com.hazelcast.map.IMap,com.hazelcast.function.BiFunctionEx)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a mapping stage where for each item a lookup in the
 supplied <code>IMap</code> using the grouping key is performed
 and the result of the lookup is merged with the item and emitted.
 <p>
 If the result of the mapping is <code>null</code>, it emits nothing.
 Therefore this stage can be used to implement filtering semantics as well.
 <p>
 The mapping logic is equivalent to:
 <pre><code>
 V value = map.get(groupingKey);
 return mapFn.apply(item, value);
 </code></pre>

 Sample usage:
 <pre><code>
 items.groupingKey(Item::getDetailId)
      .mapUsingIMap(enrichingMap, (item, detail) -&gt; item.setDetail(detail));
 </code></pre>

 This stage is similar to <a href="GeneralStage.html#mapUsingIMap(com.hazelcast.map.IMap,com.hazelcast.function.FunctionEx,com.hazelcast.function.BiFunctionEx)"><code>stageWithoutKey.mapUsingIMap()</code></a>,
 but here Jet knows the key and uses it to partition and distribute the
 input in order to achieve data locality. The value it fetches from the
 <code>IMap</code> is stored on the cluster member where the processing takes
 place. However, if the map doesn't use the default partitioning strategy,
 data locality will be broken.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#mapUsingIMap(com.hazelcast.map.IMap,com.hazelcast.function.BiFunctionEx)">mapUsingIMap</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>V</code> - type of the value in the <code>IMap</code></dd>
<dd><code>R</code> - type of the output item</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>iMap</code> - the <code>IMap</code> to use as the service</dd>
<dd><code>mapFn</code> - the mapping function. It must be stateless and <a href="../core/Processor.html#isCooperative()">cooperative</a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">mapUsingService</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;S,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">mapUsingService</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? extends R&gt;&nbsp;mapFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a mapping stage which applies the given function to each input
 item independently and emits the function's result as the output item.
 The mapping function receives another parameter, the service object,
 which Jet will create using the supplied <code>serviceFactory</code>. If the
 mapping result is <code>null</code>, it emits nothing. Therefore this stage
 can be used to implement filtering semantics as well.
 <p>
 Jet uses the <a href="GeneralStageWithKey.html#keyFn()">key-extracting function</a> specified on
 this stage for partitioning: all the items with the same key will see
 the same service instance (but note that the same instance serves many
 keys). One case where this is useful is fetching data from an external
 system because you can use a near-cache without duplicating the cached
 data.
 <p>
 Sample usage:
 <pre><code>
 items.groupingKey(Item::getDetailId)
      .mapUsingService(
          ServiceFactories.sharedService(ctx -&gt; new ItemDetailRegistry()),
          (reg, key, item) -&gt; item.setDetail(reg.fetchDetail(key))
      );
 </code></pre>

 <h3>Interaction with fault-tolerant unbounded jobs</h3>
 If you use this stage in a fault-tolerant unbounded job, keep in mind
 that any state the service object maintains doesn't participate in Jet's
 fault tolerance protocol. If the state is local, it will be lost after a
 job restart; if it is saved to some durable storage, the state of that
 storage won't be rewound to the last checkpoint, so you'll perform
 duplicate updates.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">mapUsingService</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>S</code> - type of service object</dd>
<dd><code>R</code> - the result type of the mapping function</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>serviceFactory</code> - the service factory</dd>
<dd><code>mapFn</code> - a mapping function. It must be stateless. It must be
     <a href="ServiceFactory.html#isCooperative()">cooperative</a>, if the service
     is cooperative.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">mapUsingServiceAsync</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="modifiers">default</span>&nbsp;<span class="typeParameters">&lt;S,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">mapUsingServiceAsync</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">CompletableFuture</a>&lt;R&gt;&gt;&nbsp;mapAsyncFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">GeneralStageWithKey</a></code></span></div>
<div class="block">Asynchronous version of <a href="GeneralStageWithKey.html#mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)"><code>GeneralStageWithKey.mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory&lt;?, S&gt;, com.hazelcast.jet.function.TriFunction&lt;? super S, ? super K, ? super T, ? extends R&gt;)</code></a>: the <code>mapAsyncFn</code>
 returns a <code>CompletableFuture&lt;R&gt;</code> instead of just <code>R</code>.
 <p>
 Uses default values for some extra parameters, so the maximum number
 of concurrent async operations per processor will be limited to
 4 and
 whether or not the order of input items should be preserved will be
 true.
 <p>
 The function can return a null future or the future can return a null
 result: in both cases it will act just like a filter.
 <p>
 Sample usage:
 <pre><code>
 items.groupingKey(Item::getDetailId)
      .mapUsingServiceAsync(
          ServiceFactories.sharedService(ctx -&gt; new ItemDetailRegistry()),
          (reg, key, item) -&gt; reg.fetchDetailAsync(key).thenApply(item::setDetail)
      );
 </code></pre>
 The latency of the async call will add to the total latency of the
 output.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">mapUsingServiceAsync</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>S</code> - type of service object</dd>
<dd><code>R</code> - the future's result type of the mapping function</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>serviceFactory</code> - the service factory</dd>
<dd><code>mapAsyncFn</code> - a mapping function. Can map to null (return a null
     future). It must be stateless and <a href="../core/Processor.html#isCooperative()">cooperative</a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,int,boolean,com.hazelcast.jet.function.TriFunction)">mapUsingServiceAsync</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;S,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">mapUsingServiceAsync</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
int&nbsp;maxConcurrentOps,
boolean&nbsp;preserveOrder,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">CompletableFuture</a>&lt;R&gt;&gt;&nbsp;mapAsyncFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,int,boolean,com.hazelcast.jet.function.TriFunction)">GeneralStageWithKey</a></code></span></div>
<div class="block">Asynchronous version of <a href="GeneralStageWithKey.html#mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)"><code>GeneralStageWithKey.mapUsingService(com.hazelcast.jet.pipeline.ServiceFactory&lt;?, S&gt;, com.hazelcast.jet.function.TriFunction&lt;? super S, ? super K, ? super T, ? extends R&gt;)</code></a>: the <code>mapAsyncFn</code>
 returns a <code>CompletableFuture&lt;R&gt;</code> instead of just <code>R</code>.
 <p>
 The function can return a null future or the future can return a null
 result: in both cases it will act just like a filter.
 <p>
 Sample usage:
 <pre><code>
 items.groupingKey(Item::getDetailId)
      .mapUsingServiceAsync(
          ServiceFactories.sharedService(ctx -&gt; new ItemDetailRegistry()),
          16,
          true,
          (reg, key, item) -&gt; reg.fetchDetailAsync(key).thenApply(item::setDetail)
      );
 </code></pre>
 The latency of the async call will add to the total latency of the
 output.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,int,boolean,com.hazelcast.jet.function.TriFunction)">mapUsingServiceAsync</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>S</code> - type of service object</dd>
<dd><code>R</code> - the future's result type of the mapping function</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>serviceFactory</code> - the service factory</dd>
<dd><code>maxConcurrentOps</code> - maximum number of concurrent async operations per processor</dd>
<dd><code>preserveOrder</code> - whether the async responses are ordered or not</dd>
<dd><code>mapAsyncFn</code> - a mapping function. Can map to null (return
      a null future). It must be stateless and <a href="../core/Processor.html#isCooperative()">cooperative</a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="mapUsingServiceAsyncBatched(com.hazelcast.jet.pipeline.ServiceFactory,int,com.hazelcast.function.BiFunctionEx)">mapUsingServiceAsyncBatched</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;S,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">mapUsingServiceAsyncBatched</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
int&nbsp;maxBatchSize,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../../function/BiFunctionEx.html" title="interface in com.hazelcast.function">BiFunctionEx</a>&lt;? super S,&#8203;? super <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;,&#8203;? extends <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;R&gt;&gt;&gt;&nbsp;mapAsyncFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#mapUsingServiceAsyncBatched(com.hazelcast.jet.pipeline.ServiceFactory,int,com.hazelcast.function.BiFunctionEx)">GeneralStageWithKey</a></code></span></div>
<div class="block">Batched version of <a href="GeneralStageWithKey.html#mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)"><code>GeneralStageWithKey.mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory&lt;?, S&gt;, com.hazelcast.jet.function.TriFunction&lt;? super S, ? super K, ? super T, java.util.concurrent.CompletableFuture&lt;R&gt;&gt;)</code></a>: <code>mapAsyncFn</code> takes
 a list of input items and returns a <code>CompletableFuture&lt;List&lt;R&gt;&gt;</code>.
 The size of list is limited by the given <code>maxBatchSize</code>.
 <p>
 This transform can perform filtering by putting <code>null</code> elements into
 the output list.
 <p>
 The latency of the async call will add to the total latency of the
 output.
 <p>
 This sample takes a stream of stock items and sets the <code>detail</code>
 field on them by performing batched lookups from a registry. The max
 size of the items to lookup is specified as <code>100</code>:
 <pre><code>
 items.groupingKey(Item::getDetailId)
      .mapUsingServiceAsyncBatched(
          ServiceFactories.sharedService(ctx -&gt; new ItemDetailRegistry()),
          100,
          (reg, itemList) -&gt; reg
              .fetchDetailsAsync(itemList.stream().map(Item::getDetailId).collect(Collectors.toList()))
              .thenApply(details -&gt; {
                  for (int i = 0; i &lt; itemList.size(); i++) {
                      itemList.get(i).setDetail(details.get(i));
                  }
                  return itemList;
              })
      );
 </code></pre></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#mapUsingServiceAsyncBatched(com.hazelcast.jet.pipeline.ServiceFactory,int,com.hazelcast.function.BiFunctionEx)">mapUsingServiceAsyncBatched</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>S</code> - type of service object</dd>
<dd><code>R</code> - the future result type of the mapping function</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>serviceFactory</code> - the service factory</dd>
<dd><code>maxBatchSize</code> - max size of the input list</dd>
<dd><code>mapAsyncFn</code> - a mapping function. It must be stateless. It must be
     <a href="ServiceFactory.html#isCooperative()">cooperative</a>, if the service
     is cooperative.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="mapUsingServiceAsyncBatched(com.hazelcast.jet.pipeline.ServiceFactory,int,com.hazelcast.jet.function.TriFunction)">mapUsingServiceAsyncBatched</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;S,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">mapUsingServiceAsyncBatched</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
int&nbsp;maxBatchSize,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;,&#8203;? super <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;,&#8203;? extends <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent" class="externalLink">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;R&gt;&gt;&gt;&nbsp;mapAsyncFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#mapUsingServiceAsyncBatched(com.hazelcast.jet.pipeline.ServiceFactory,int,com.hazelcast.jet.function.TriFunction)">GeneralStageWithKey</a></code></span></div>
<div class="block">Batched version of <a href="GeneralStageWithKey.html#mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)"><code>GeneralStageWithKey.mapUsingServiceAsync(com.hazelcast.jet.pipeline.ServiceFactory&lt;?, S&gt;, com.hazelcast.jet.function.TriFunction&lt;? super S, ? super K, ? super T, java.util.concurrent.CompletableFuture&lt;R&gt;&gt;)</code></a>: <code>mapAsyncFn</code> takes
 a list of input items (and a list of their corresponding keys) and
 returns a <code>CompletableFuture&lt;List&lt;R&gt;&gt;</code>.
 The sizes of the input lists are identical and are limited by the given
 <code>maxBatchSize</code>. The key at index N corresponds to the input item
 at index N.
 <p>
 The number of in-flight batches being completed asynchronously is
 limited to 2
 and this mapping operation always preserves the order of input elements.
 <p>
 This transform can perform filtering by putting <code>null</code> elements into
 the output list.
 <p>
 The latency of the async call will add to the total latency of the
 output.
 <p>
 This sample takes a stream of stock items and sets the <code>detail</code>
 field on them by performing batched lookups from a registry. The max
 size of the items to lookup is specified as <code>100</code>:
 <p>
 <pre><code>
 items.groupingKey(Item::getDetailId)
      .mapUsingServiceAsyncBatched(
          ServiceFactories.sharedService(ctx -&gt; new ItemDetailRegistry()),
          100,
          (reg, keyList, itemList) -&gt; reg.fetchDetailsAsync(keyList).thenApply(details -&gt; {
              for (int i = 0; i &lt; itemList.size(); i++) {
                  itemList.get(i).setDetail(details.get(i));
              }
              return itemList;
          })
      );
 </code></pre></div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#mapUsingServiceAsyncBatched(com.hazelcast.jet.pipeline.ServiceFactory,int,com.hazelcast.jet.function.TriFunction)">mapUsingServiceAsyncBatched</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>S</code> - type of service object</dd>
<dd><code>R</code> - the future result type of the mapping function</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>serviceFactory</code> - the service factory</dd>
<dd><code>maxBatchSize</code> - max size of the input list</dd>
<dd><code>mapAsyncFn</code> - a mapping function. It must be stateless and
     <a href="../core/Processor.html#isCooperative()">cooperative</a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="filterUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriPredicate)">filterUsingService</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;S&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;</span>&nbsp;<span class="memberName">filterUsingService</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../function/TriPredicate.html" title="interface in com.hazelcast.jet.function">TriPredicate</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>&gt;&nbsp;filterFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#filterUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriPredicate)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a filtering stage which applies the provided predicate function
 to each input item to decide whether to pass the item to the output or
 to discard it. The predicate function receives another parameter, the
 service object, which Jet will create using the supplied <code>
 serviceFactory</code>.
 <p>
 The number of in-flight batches being completed asynchronously is
 limited to 2
 and this mapping operation always preserves the order of input elements.
 <p>
 Jet uses the <a href="GeneralStageWithKey.html#keyFn()">key-extracting function</a> specified on
 this stage for partitioning: all the items with the same key will see
 the same service instance (but note that the same instance serves many
 keys). One case where this is useful is fetching data from an external
 system because you can use a near-cache without duplicating the cached
 data.
 <p>
 Sample usage:
 <pre><code>
 items.groupingKey(Item::getDetailId)
      .filterUsingService(
          ServiceFactories.sharedService(ctx -&gt; new ItemDetailRegistry()),
          (reg, key, item) -&gt; reg.fetchDetail(key).contains("blade")
      );
 </code></pre>

 <h3>Interaction with fault-tolerant unbounded jobs</h3>
 If you use this stage in a fault-tolerant unbounded job, keep in mind
 that any state the service object maintains doesn't participate in Jet's
 fault tolerance protocol. If the state is local, it will be lost after a
 job restart; if it is saved to some durable storage, the state of that
 storage won't be rewound to the last checkpoint, so you'll perform
 duplicate updates.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#filterUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriPredicate)">filterUsingService</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>S</code> - type of service object</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>serviceFactory</code> - the service factory</dd>
<dd><code>filterFn</code> - a filter predicate function. It must be stateless. It
     must be <a href="ServiceFactory.html#isCooperative()">cooperative</a>, if the
     service is cooperative.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="flatMapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">flatMapUsingService</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;S,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">flatMapUsingService</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="ServiceFactory.html" title="class in com.hazelcast.jet.pipeline">ServiceFactory</a>&lt;?,&#8203;S&gt;&nbsp;serviceFactory,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../function/TriFunction.html" title="interface in com.hazelcast.jet.function">TriFunction</a>&lt;? super S,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? extends <a href="../Traverser.html" title="interface in com.hazelcast.jet">Traverser</a>&lt;R&gt;&gt;&nbsp;flatMapFn)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#flatMapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a flat-mapping stage which applies the supplied function to
 each input item independently and emits all the items from the
 <a href="../Traverser.html" title="interface in com.hazelcast.jet"><code>Traverser</code></a> it returns as the output items. The traverser must
 be <em>null-terminated</em>. The mapping function receives another
 parameter, the service object, which Jet will create using the supplied
 <code>serviceFactory</code>.
 <p>
 Jet uses the <a href="GeneralStageWithKey.html#keyFn()">key-extracting function</a> specified on
 this stage for partitioning: all the items with the same key will see
 the same service instance (but note that the same instance serves many
 keys). One case where this is useful is fetching data from an external
 system because you can use a near-cache without duplicating the cached
 data.
 <p>
 Sample usage:
 <pre><code>
 StreamStage&lt;Part&gt; parts = products
     .groupingKey(Product::getId)
     .flatMapUsingService(
         ServiceFactories.sharedService(ctx -&gt; new PartRegistry()),
         (registry, productId, product) -&gt; Traversers.traverseIterable(
                 registry.fetchParts(productId))
     );
 </code></pre>

 <h3>Interaction with fault-tolerant unbounded jobs</h3>
 If you use this stage in a fault-tolerant unbounded job, keep in mind
 that any state the service object maintains doesn't participate in Jet's
 fault tolerance protocol. If the state is local, it will be lost after a
 job restart; if it is saved to some durable storage, the state of that
 storage won't be rewound to the last checkpoint, so you'll perform
 duplicate updates.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#flatMapUsingService(com.hazelcast.jet.pipeline.ServiceFactory,com.hazelcast.jet.function.TriFunction)">flatMapUsingService</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>S</code> - type of service object</dd>
<dd><code>R</code> - type of the output items</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>serviceFactory</code> - the service factory</dd>
<dd><code>flatMapFn</code> - a flatmapping function. It must not return null
     traverser, but can return an <a href="../Traversers.html#empty()">empty
     traverser</a>. It must be stateless. It must be <a href="ServiceFactory.html#isCooperative()">cooperative</a>, if the service is
     cooperative.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the newly attached stage</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="aggregate(com.hazelcast.jet.aggregate.AggregateOperation1)">aggregate</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;R&gt;&gt;</span>&nbsp;<span class="memberName">aggregate</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;?,&#8203;? extends R&gt;&nbsp;aggrOp)</span></div>
<div class="block">Attaches a stage that performs the given group-and-aggregate operation.
 It emits one key-value pair (in a <code>Map.Entry</code>) for each distinct
 key it observes in its input. The value is the result of the aggregate
 operation across all the items with the given grouping key.
 <p>
 Sample usage:
 <pre><code>
 BatchStage&lt;Entry&lt;String, Long&gt;&gt; aggregated = people.
         .groupingKey(Person::getLastName)
         .aggregate(AggregateOperations.counting());
 </code></pre></div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>R</code> - type of the aggregation result</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>aggrOp</code> - the aggregate operation to perform</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../aggregate/AggregateOperations.html" title="class in com.hazelcast.jet.aggregate"><code>AggregateOperations</code></a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="aggregate2(com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation2)">aggregate2</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;T1,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;R&gt;&gt;</span>&nbsp;<span class="memberName">aggregate2</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;T1,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage1,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../aggregate/AggregateOperation2.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation2</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? super T1,&#8203;?,&#8203;R&gt;&nbsp;aggrOp)</span></div>
<div class="block">Attaches a stage that performs the given cogroup-and-aggregate operation
 over the items from both this stage and <code>stage1</code> you supply. It
 emits one key-value pair (in a <code>Map.Entry</code>) for each distinct key
 it observes in its input. The value is the result of the aggregate
 operation across all the items with the given grouping key.
 <p>
 Sample usage:
 <pre><code>
 BatchStage&lt;Entry&lt;Long, Tuple2&lt;Long, Long&gt;&gt;&gt; aggregated = pageVisits
         .groupingKey(PageVisit::getUserId)
         .aggregate2(addToCarts.groupingKey(AddToCart::getUserId),
                 aggregateOperation2(
                         AggregateOperations.counting(),
                         AggregateOperations.counting())
         );
 </code></pre>
 This variant requires you to provide a two-input aggregate operation. If
 you can express your logic in terms of two single-input aggregate
 operations, one for each input stream, then you should use <a href="#aggregate2(com.hazelcast.jet.aggregate.AggregateOperation1,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation1)"><code>stage0.aggregate2(aggrOp0, stage1, aggrOp1)</code></a> because it offers a simpler
 API. Use this variant only when your aggregate operation must combine
 the input streams into the same accumulator.</div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T1</code> - type of items in <code>stage1</code></dd>
<dd><code>R</code> - type of the aggregation result</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>aggrOp</code> - the aggregate operation to perform</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../aggregate/AggregateOperations.html" title="class in com.hazelcast.jet.aggregate"><code>AggregateOperations</code></a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="aggregate2(com.hazelcast.jet.aggregate.AggregateOperation1,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation1)">aggregate2</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="modifiers">default</span>&nbsp;<span class="typeParameters">&lt;T1,&#8203;
R0,&#8203;
R1&gt;</span>
<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;<a href="../datamodel/Tuple2.html" title="class in com.hazelcast.jet.datamodel">Tuple2</a>&lt;R0,&#8203;R1&gt;&gt;&gt;</span>&nbsp;<span class="memberName">aggregate2</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;?,&#8203;? extends R0&gt;&nbsp;aggrOp0,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;? extends T1,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage1,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super T1,&#8203;?,&#8203;? extends R1&gt;&nbsp;aggrOp1)</span></div>
<div class="block">Attaches a stage that performs the given cogroup-and-aggregate
 transformation of the items from both this stage and <code>stage1</code>
 you supply. For each distinct grouping key it performs the supplied
 aggregate operation across all the items sharing that key. It
 performs the aggregation separately for each input stage: <code>
 aggrOp0</code> on this stage and <code>aggrOp1</code> on <code>stage1</code>. Once it
 has received all the items, it emits for each distinct key a <code>
 Map.Entry(key, Tuple2(result0, result1))</code>.
 <p>
 Sample usage:
 <pre><code>
 BatchStage&lt;Entry&lt;Long, Tuple2&lt;Long, Long&gt;&gt;&gt; aggregated = pageVisits
         .groupingKey(PageVisit::getUserId)
         .aggregate2(
                 AggregateOperations.counting(),
                 addToCarts.groupingKey(AddToCart::getUserId),
                 AggregateOperations.counting()
         );
 </code></pre></div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>R0</code> - type of the aggregation result for stream-0</dd>
<dd><code>T1</code> - type of items in <code>stage1</code></dd>
<dd><code>R1</code> - type of the aggregation result for stream-1</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>aggrOp0</code> - aggregate operation to perform on this stage</dd>
<dd><code>stage1</code> - the other stage</dd>
<dd><code>aggrOp1</code> - aggregate operation to perform on the other stage</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../aggregate/AggregateOperations.html" title="class in com.hazelcast.jet.aggregate"><code>AggregateOperations</code></a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="aggregate3(com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation3)">aggregate3</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;T1,&#8203;
T2,&#8203;
R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;R&gt;&gt;</span>&nbsp;<span class="memberName">aggregate3</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;T1,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage1,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;T2,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage2,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../aggregate/AggregateOperation3.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation3</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;? super T1,&#8203;? super T2,&#8203;?,&#8203;? extends R&gt;&nbsp;aggrOp)</span></div>
<div class="block">Attaches a stage that performs the given cogroup-and-aggregate operation
 over the items from this stage as well as <code>stage1</code> and <code>
 stage2</code> you supply. It emits one key-value pair (in a <code>Map.Entry</code>)
 for each distinct key it observes in its input. The value is the result
 of the aggregate operation across all the items with the given grouping
 key.
 <p>
 Sample usage:
 <pre><code>
 BatchStage&lt;Entry&lt;Long, Tuple3&lt;Long, Long, Long&gt;&gt;&gt; aggregated = pageVisits
         .groupingKey(PageVisit::getUserId)
         .aggregate3(
                 addToCarts.groupingKey(AddToCart::getUserId),
                 payments.groupingKey(Payment::getUserId),
                 aggregateOperation3(
                         AggregateOperations.counting(),
                         AggregateOperations.counting(),
                         AggregateOperations.counting())
         );
 </code></pre>
 This variant requires you to provide a three-input aggregate operation.
 If you can express your logic in terms of three single-input aggregate
 operations, one for each input stream, then you should use <a href="#aggregate3(com.hazelcast.jet.aggregate.AggregateOperation1,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation1,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation1)"><code>stage0.aggregate2(aggrOp0, stage1, aggrOp1, stage2, aggrOp2)</code></a> because it
 offers a simpler API. Use this variant only when your aggregate
 operation must combine the input streams into the same accumulator.</div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T1</code> - type of items in <code>stage1</code></dd>
<dd><code>T2</code> - type of items in <code>stage2</code></dd>
<dd><code>R</code> - type of the aggregation result</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>aggrOp</code> - the aggregate operation to perform</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../aggregate/AggregateOperations.html" title="class in com.hazelcast.jet.aggregate"><code>AggregateOperations</code></a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="aggregate3(com.hazelcast.jet.aggregate.AggregateOperation1,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation1,com.hazelcast.jet.pipeline.BatchStageWithKey,com.hazelcast.jet.aggregate.AggregateOperation1)">aggregate3</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="modifiers">default</span>&nbsp;<span class="typeParameters">&lt;T1,&#8203;
T2,&#8203;
R0,&#8203;
R1,&#8203;
R2&gt;</span>
<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html?is-external=true" title="class or interface in java.util" class="externalLink">Map.Entry</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;<a href="../datamodel/Tuple3.html" title="class in com.hazelcast.jet.datamodel">Tuple3</a>&lt;R0,&#8203;R1,&#8203;R2&gt;&gt;&gt;</span>&nbsp;<span class="memberName">aggregate3</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;?,&#8203;? extends R0&gt;&nbsp;aggrOp0,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;T1,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage1,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super T1,&#8203;?,&#8203;? extends R1&gt;&nbsp;aggrOp1,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="BatchStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">BatchStageWithKey</a>&lt;T2,&#8203;? extends <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;&nbsp;stage2,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super T2,&#8203;?,&#8203;? extends R2&gt;&nbsp;aggrOp2)</span></div>
<div class="block">Attaches a stage that performs the given cogroup-and-aggregate
 transformation of the items from this stage as well as <code>stage1</code>
 and <code>stage2</code> you supply. For each distinct grouping key it
 observes in the input, it performs the supplied aggregate operation
 across all the items sharing that key. It performs the aggregation
 separately for each input stage: <code>aggrOp0</code> on this stage, <code>
 aggrOp1</code> on <code>stage1</code> and <code>aggrOp2</code> on <code>stage2</code>. Once
 it has received all the items, it emits for each distinct key a <code>
 Map.Entry(key, Tuple3(result0, result1, result2))</code>.
 <p>
 Sample usage:
 <pre><code>
 BatchStage&lt;Entry&lt;Long, Tuple3&lt;Long, Long, Long&gt;&gt;&gt; aggregated = pageVisits
         .groupingKey(PageVisit::getUserId)
         .aggregate3(
                 AggregateOperations.counting(),
                 addToCarts.groupingKey(AddToCart::getUserId),
                 AggregateOperations.counting(),
                 payments.groupingKey(Payment::getUserId),
                 AggregateOperations.counting()
         );
 </code></pre></div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T1</code> - type of items in <code>stage1</code></dd>
<dd><code>T2</code> - type of items in <code>stage2</code></dd>
<dd><code>R0</code> - type of the aggregation result for stream-0</dd>
<dd><code>R1</code> - type of the aggregation result for stream-1</dd>
<dd><code>R2</code> - type of the aggregation result for stream-2</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>aggrOp0</code> - aggregate operation to perform on this stage</dd>
<dd><code>stage1</code> - the first additional stage</dd>
<dd><code>aggrOp1</code> - aggregate operation to perform on <code>stage1</code></dd>
<dd><code>stage2</code> - the second additional stage</dd>
<dd><code>aggrOp2</code> - aggregate operation to perform on <code>stage2</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../aggregate/AggregateOperations.html" title="class in com.hazelcast.jet.aggregate"><code>AggregateOperations</code></a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="aggregateBuilder(com.hazelcast.jet.aggregate.AggregateOperation1)">aggregateBuilder</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="modifiers">default</span>&nbsp;<span class="typeParameters">&lt;R0&gt;</span>&nbsp;<span class="returnType"><a href="GroupAggregateBuilder.html" title="class in com.hazelcast.jet.pipeline">GroupAggregateBuilder</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>,&#8203;R0&gt;</span>&nbsp;<span class="memberName">aggregateBuilder</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../aggregate/AggregateOperation1.html" title="interface in com.hazelcast.jet.aggregate">AggregateOperation1</a>&lt;? super <a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;?,&#8203;? extends R0&gt;&nbsp;aggrOp0)</span></div>
<div class="block">Offers a step-by-step API to build a pipeline stage that co-aggregates
 the data from several input stages. The current stage will be already
 registered with the builder you get. You supply an aggregate operation
 for each input stage and in the output you get the individual
 aggregation results in a <code>Map.Entry(key, itemsByTag)</code>. Use the tag
 you get from <a href="AggregateBuilder.html#add(com.hazelcast.jet.pipeline.BatchStage,com.hazelcast.jet.aggregate.AggregateOperation1)"><code>builder.add(stageN)</code></a> to
 retrieve the aggregated result for that stage. Use <a href="AggregateBuilder.html#tag0()"><code>builder.tag0()</code></a> as the tag of this stage. You
 will also be able to supply a function to the builder that immediately
 transforms the <code>ItemsByTag</code> to the desired output type.
 <p>
 This example reads from three sources that produce <code>
 Map.Entry&lt;String, Long&gt;</code>. It groups by entry key and then counts the
 items in stage-0, sums those in stage-1 and takes the average of those
 in stage-2:
 <pre><code>
 Pipeline p = Pipeline.create();
 StageWithGrouping&lt;Entry&lt;String, Long&gt;, String&gt; stage0 =
         p.readFrom(source0).groupingKey(Entry::getKey);
 StageWithGrouping&lt;Entry&lt;String, Long&gt;, String&gt; stage1 =
         p.readFrom(source1).groupingKey(Entry::getKey);
 StageWithGrouping&lt;Entry&lt;String, Long&gt;, String&gt; stage2 =
         p.readFrom(source2).groupingKey(Entry::getKey);

 GroupAggregateBuilder&lt;String, Long&gt; b = stage0.aggregateBuilder(
         AggregateOperations.counting());
 Tag&lt;Long&gt; tag0 = b.tag0();
 Tag&lt;Long&gt; tag1 = b.add(stage1,
         AggregateOperations.summingLong(Entry::getValue));
 Tag&lt;Double&gt; tag2 = b.add(stage2,
         AggregateOperations.averagingLong(Entry::getValue));
 BatchStage&lt;Entry&lt;String, ItemsByTag&gt;&gt; aggregated = b.build();
 aggregated.map(e -&gt; String.format(
         "Key %s, count of stage0: %d, sum of stage1: %d, average of stage2: %f",
         e.getKey(),
         e.getValue().get(tag0), e.getValue().get(tag1), e.getValue().get(tag2))
 );
</code></pre></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="aggregateBuilder()">aggregateBuilder</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="modifiers">default</span>&nbsp;<span class="returnType"><a href="GroupAggregateBuilder1.html" title="class in com.hazelcast.jet.pipeline">GroupAggregateBuilder1</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</span>&nbsp;<span class="memberName">aggregateBuilder</span>()</div>
<div class="block">Offers a step-by-step API to build a pipeline stage that co-aggregates
 the data from several input stages. The current stage will be already
 registered with the builder you get.
 <p>
 This builder requires you to provide a multi-input aggregate operation.
 If you can express your logic in terms of single-input aggregate
 operations, one for each input stream, then you should use <a href="#aggregateBuilder(com.hazelcast.jet.aggregate.AggregateOperation1)"><code>stage0.aggregateBuilder(aggrOp0)</code></a>
 because it offers a simpler API. Use this builder only when you have the
 need to implement an aggregate operation that combines all the input
 streams into the same accumulator.
 <p>
 This builder is mainly intended to build a co-aggregation of four or
 more contributing stages. For up to three stages, prefer the direct
 <code>stage.aggregateN(...)</code> calls because they offer more static type
 safety.
 <p>
 To add the other stages, call <a href="GroupAggregateBuilder1.html#add(com.hazelcast.jet.pipeline.BatchStageWithKey)"><code>add(stage)</code></a>. Collect all the tags returned from <code>add()</code> and use
 them when building the aggregate operation. Retrieve the tag of the
 first stage (from which you obtained this builder) by calling <a href="GroupAggregateBuilder1.html#tag0()"><code>GroupAggregateBuilder1.tag0()</code></a>.
 <p>
 This example takes three streams of <code>Map.Entry&lt;String, Long&gt;</code> and,
 for each string key, counts the distinct <code>Long</code> values across all
 input streams:
 <pre><code>
 Pipeline p = Pipeline.create();

 StageWithGrouping&lt;Entry&lt;String, Long&gt;, String&gt; stage0 =
         p.readFrom(source0).groupingKey(Entry::getKey);
 StageWithGrouping&lt;Entry&lt;String, Long&gt;, String&gt; stage1 =
         p.readFrom(source1).groupingKey(Entry::getKey);
 StageWithGrouping&lt;Entry&lt;String, Long&gt;, String&gt; stage2 =
         p.readFrom(source2).groupingKey(Entry::getKey);

 GroupAggregateBuilder1&lt;Entry&lt;String, Long&gt;, String&gt; b = stage0.aggregateBuilder();
 Tag&lt;Entry&lt;String, Long&gt;&gt; tag0 = b.tag0();
 Tag&lt;Entry&lt;String, Long&gt;&gt; tag1 = b.add(stage1);
 Tag&lt;Entry&lt;String, Long&gt;&gt; tag2 = b.add(stage2);
 BatchStage&lt;Entry&lt;String, Integer&gt;&gt; aggregated = b.build(AggregateOperation
         .withCreate(HashSet&lt;Long&gt;::new)
         .andAccumulate(tag0, (acc, item) -&gt; acc.add(item.getValue()))
         .andAccumulate(tag1, (acc, item) -&gt; acc.add(item.getValue()))
         .andAccumulate(tag2, (acc, item) -&gt; acc.add(item.getValue()))
         .andCombine(HashSet::addAll)
         .andFinish(HashSet::size));
 </code></pre></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="customTransform(java.lang.String,com.hazelcast.function.SupplierEx)">customTransform</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="modifiers">default</span>&nbsp;<span class="typeParameters">&lt;R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">customTransform</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;stageName,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../../function/SupplierEx.html" title="interface in com.hazelcast.function">SupplierEx</a>&lt;<a href="../core/Processor.html" title="interface in com.hazelcast.jet.core">Processor</a>&gt;&nbsp;procSupplier)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#customTransform(java.lang.String,com.hazelcast.function.SupplierEx)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a stage with a custom transform based on the provided supplier
 of Core API <a href="../core/Processor.html" title="interface in com.hazelcast.jet.core"><code>Processor</code></a>s. The inbound edge will be distributed and
 partitioned using the key function assigned to this stage.
 <p>
 Note that the type parameter of the returned stage is inferred from the
 call site and not propagated from the processor that will produce the
 result, so there is no actual type safety provided.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#customTransform(java.lang.String,com.hazelcast.function.SupplierEx)">customTransform</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>R</code> - the type of the output items</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>stageName</code> - a human-readable name for the custom stage</dd>
<dd><code>procSupplier</code> - the supplier of processors</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="customTransform(java.lang.String,com.hazelcast.jet.core.ProcessorSupplier)">customTransform</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="modifiers">default</span>&nbsp;<span class="typeParameters">&lt;R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">customTransform</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;stageName,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../core/ProcessorSupplier.html" title="interface in com.hazelcast.jet.core">ProcessorSupplier</a>&nbsp;procSupplier)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#customTransform(java.lang.String,com.hazelcast.jet.core.ProcessorSupplier)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a stage with a custom transform based on the provided supplier
 of Core API <a href="../core/Processor.html" title="interface in com.hazelcast.jet.core"><code>Processor</code></a>s. The inbound edge will be distributed and
 partitioned using the key function assigned to this stage.
 <p>
 Note that the type parameter of the returned stage is inferred from the
 call site and not propagated from the processor that will produce the
 result, so there is no actual type safety provided.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#customTransform(java.lang.String,com.hazelcast.jet.core.ProcessorSupplier)">customTransform</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>R</code> - the type of the output items</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>stageName</code> - a human-readable name for the custom stage</dd>
<dd><code>procSupplier</code> - the supplier of processors</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="customTransform(java.lang.String,com.hazelcast.jet.core.ProcessorMetaSupplier)">customTransform</a></h3>
<div class="memberSignature"><span class="annotations"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
</span><span class="typeParameters">&lt;R&gt;</span>&nbsp;<span class="returnType"><a href="BatchStage.html" title="interface in com.hazelcast.jet.pipeline">BatchStage</a>&lt;R&gt;</span>&nbsp;<span class="memberName">customTransform</span>&#8203;(<span class="arguments"><a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;stageName,
<a href="https://docs.oracle.com/javase/8/docs/api/javax/annotation/Nonnull.html?is-external=true" title="class or interface in javax.annotation" class="externalLink">@Nonnull</a>
<a href="../core/ProcessorMetaSupplier.html" title="interface in com.hazelcast.jet.core">ProcessorMetaSupplier</a>&nbsp;procSupplier)</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="GeneralStageWithKey.html#customTransform(java.lang.String,com.hazelcast.jet.core.ProcessorMetaSupplier)">GeneralStageWithKey</a></code></span></div>
<div class="block">Attaches a stage with a custom transform based on the provided supplier
 of Core API <a href="../core/Processor.html" title="interface in com.hazelcast.jet.core"><code>Processor</code></a>s. The inbound edge will be distributed and
 partitioned using the key function assigned to this stage.
 <p>
 Note that the type parameter of the returned stage is inferred from the
 call site and not propagated from the processor that will produce the
 result, so there is no actual type safety provided.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="GeneralStageWithKey.html#customTransform(java.lang.String,com.hazelcast.jet.core.ProcessorMetaSupplier)">customTransform</a></code>&nbsp;in interface&nbsp;<code><a href="GeneralStageWithKey.html" title="interface in com.hazelcast.jet.pipeline">GeneralStageWithKey</a>&lt;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">T</a>,&#8203;<a href="BatchStageWithKey.html" title="type parameter in BatchStageWithKey">K</a>&gt;</code></dd>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>R</code> - the type of the output items</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>stageName</code> - a human-readable name for the custom stage</dd>
<dd><code>procSupplier</code> - the supplier of processors</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BatchStageWithKey.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2021 <a href="http://www.hazelcast.com/">Hazelcast, Inc.</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
